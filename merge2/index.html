<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì‚¬ì§„ ë¶„ë¥˜ ë° ì›ê³  ì‘ì„±ê¸° (iframe)</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="stylesheet" href="style.css?v=2.1">
  <style>
    /* ì‹œê°„ëŒ€ë³„ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
    .time-message {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.98);
        padding: 30px 35px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        z-index: 10001;
        display: none;
        max-width: 350px;
        animation: slideIn 0.5s ease;
    }
    
    .time-message.active {
        display: block;
    }
    
    .time-message .close-btn {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        cursor: pointer;
        color: #999;
        background: none;
        border: none;
        padding: 5px;
        transition: all 0.3s ease;
    }
    
    .time-message .close-btn:hover {
        color: #333;
        transform: scale(1.1);
    }
    
    .time-message h3 {
        margin: 0 0 15px 0;
        font-size: 21px;
        line-height: 1.4;
        text-align: center;
    }
    
    .time-message p {
        font-size: 17px;
        line-height: 1.8;
        margin: 0;
        color: #555;
        text-align: center;
    }
    
    @keyframes slideIn {
        from {
            transform: translateX(400px);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    /* ì›ê³  ì‘ì„±ìš© ì´í•©ë³¸ í† ê¸€ ìŠ¤ìœ„ì¹˜ ìŠ¤íƒ€ì¼ */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    .toggle-switch input:checked + .toggle-slider {
      background-color: #4CAF50;
    }

    .toggle-switch input:focus + .toggle-slider {
      box-shadow: 0 0 1px #4CAF50;
    }

    .toggle-switch input:checked + .toggle-slider:before {
      transform: translateX(26px);
    }

    /* ë‹¤í¬ ëª¨ë“œ í† ê¸€ ìŠ¤íƒ€ì¼ */
    [data-theme="dark"] .toggle-slider {
      background-color: #555;
    }

    [data-theme="dark"] .toggle-switch input:checked + .toggle-slider {
      background-color: #66bb6a;
    }

    .manuscript-toggle-container {
      padding: 8px 12px;
      background: var(--bg-color, #ffffff);
      border: 1px solid var(--border-color, #ddd);
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 4px 0;
    }

    .manuscript-toggle-container label[for="manuscriptToggle"],
    .manuscript-toggle-container label[for="videoToggle"] {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-color, #333);
      margin: 0;
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <div class="top-controls">
    <button class="theme-toggle" id="themeToggle">ğŸŒ™</button>
    <button class="zoom-toggle" id="zoomToggle">ğŸ” ì‚¬ì§„ í™•ëŒ€</button>
    <button class="preview-count-toggle" id="previewCountToggle">ğŸ“Š ë¯¸ë¦¬ë³´ê¸° í˜„í™©</button>
    <div style="position: relative;">
      <button class="menu-tab" id="menuTab">â˜° ë©”ë‰´</button>
      <div class="menu-dropdown" id="menuDropdown">
        <div class="menu-item" onclick="app.resetEntirePage()">ğŸ—‘ï¸ ì „ì²´ ì´ˆê¸°í™”</div>
        <div class="menu-divider"></div>
        <div class="menu-section-title">SQL ë°ì´í„°ë§Œ</div>
        <div class="menu-item" onclick="app.exportSQLData()">ğŸ“¤ SQL ë°ì´í„° ë‚´ë³´ë‚´ê¸°</div>
        <div class="menu-item" onclick="app.importSQLData()">ğŸ“¥ SQL ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</div>
        <div class="menu-divider"></div>
        <div class="menu-section-title">ì „ì²´ ë°±ì—… (SQL + ì´ë¯¸ì§€)</div>
        <div class="menu-item" onclick="app.exportFullBackup()">ğŸ’¾ ì „ì²´ ë°±ì—… ë‚´ë³´ë‚´ê¸°</div>
        <div class="menu-item" onclick="app.importFullBackup()">ğŸ“¦ ì „ì²´ ë°±ì—… ê°€ì ¸ì˜¤ê¸°</div>
        <div class="menu-divider"></div>
        <div class="menu-item" onclick="app.resetSQLData()">ğŸ”„ SQL ë°ì´í„° ì´ˆê¸°í™”</div>
      </div>
    </div>
  </div>
  
  <h1>ğŸ–¼ï¸ ì‚¬ì§„ ë¶„ë¥˜ + âœï¸ì›ê³  ì‘ì„±ê¸° (iframe)</h1>
  
  <div id="categories"></div>
  
  <button id="finalizeBtn">âœ… í™•ì •í•˜ê¸°</button>
  
  <div id="finalPreviewContainer" style="display:none;">
    <h2>ğŸ¯ ìµœì¢… ì •ë ¬</h2>
    <div id="finalPreview" class="sortable"></div>
    <div class="export-settings">
      <h4>ğŸ“¦ Export ì„¤ì •</h4>
      
      <!-- ì‚¬ì§„ ê°’ ë³€ê²½ ì„¤ì • -->
      <div class="modification-settings">
        <h4>ğŸ–¼ï¸ ì‚¬ì§„ ê°’ ë³€ê²½ (ë„¤ì´ë²„ ì¤‘ë³µë°©ì§€)</h4>
        <div class="modification-options">
          <div class="modification-option" data-option="none">
            <div class="option-header">
              <span class="option-icon">ğŸš«</span>
              <span class="option-title">ë³€ê²½ ì•ˆí•¨</span>
            </div>
            <div class="option-description">ì›ë³¸ ê·¸ëŒ€ë¡œ ìœ ì§€</div>
          </div>
          
          <div class="modification-option" data-option="border">
            <div class="option-header">
              <span class="option-icon">ğŸ–¼ï¸</span>
              <span class="option-title">í…Œë‘ë¦¬ ì¶”ê°€</span>
            </div>
            <div class="option-description">ëœë¤ ìƒ‰ìƒ í…Œë‘ë¦¬ ì¶”ê°€</div>
            <div class="option-input">
              <label>ë‘ê»˜: 
                <select id="borderWidth">
                  <option value="1" selected>1px</option>
                  <option value="2">2px</option>
                  <option value="3">3px</option>
                  <option value="4">4px</option>
                </select>
              </label>
              <label>ìƒ‰ìƒ: 
                <select id="borderColor">
                  <option value="white" selected>í™”ì´íŠ¸</option>
                  <option value="gray">ê·¸ë ˆì´</option>
                  <option value="black">ë¸”ë™</option>
                </select>
              </label>
            </div>
          </div>
          
          <div class="modification-option active" data-option="noise">
            <div class="option-header">
              <span class="option-icon">âš¡</span>
              <span class="option-title">ë…¸ì´ì¦ˆ ì¶”ê°€</span>
            </div>
            <div class="option-description">ê°€ì¥ìë¦¬ 50px ì˜ì—­ì— ë¯¸ì„¸ ë…¸ì´ì¦ˆ ì¶”ê°€</div>
            <div class="option-input">
              <label>ê°œìˆ˜: 
                <select id="noiseCount">
                  <option value="10">10ê°œ</option>
                  <option value="20">20ê°œ</option>
                  <option value="30">30ê°œ</option>
                  <option value="40">40ê°œ</option>
                  <option value="50" selected>50ê°œ</option>
                  <option value="60">60ê°œ</option>
                  <option value="70">70ê°œ</option>
                  <option value="80">80ê°œ</option>
                  <option value="90">90ê°œ</option>
                  <option value="100">100ê°œ</option>
                </select>
              </label>
            </div>
          </div>
          
          <div class="modification-option active" data-option="exif">
            <div class="option-header">
              <span class="option-icon">ğŸ“·</span>
              <span class="option-title">EXIFì •ë³´ ì œê±°</span>
            </div>
            <div class="option-description">ì¹´ë©”ë¼ ì •ë³´ ë“± ë©”íƒ€ë°ì´í„° ì œê±°</div>
          </div>
          
          <div class="modification-option active" data-option="adjust">
            <div class="option-header">
              <span class="option-icon">ğŸ¨</span>
              <span class="option-title">ë°ê¸°/ëŒ€ë¹„ ì¡°ì ˆ</span>
            </div>
            <div class="option-description">ë°ê¸°/ëŒ€ë¹„ 1~3% ëœë¤ ì¡°ì •</div>
          </div>
        </div>
        
        <!-- ì›ê³  ë§Œë“¤ê¸° ì„¤ì • ì¶”ê°€ -->
        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
          <h4>ğŸ“ AI ì›ê³  ìƒì„±</h4>
          <div class="manuscript-toggle-container" style="margin-top: 10px;">
            <label for="aiManuscriptToggle">AI ë¸”ë¡œê·¸ ì›ê³  ìƒì„±</label>
            <label class="toggle-switch">
              <input type="checkbox" id="aiManuscriptToggle">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <p style="font-size: 12px; color: #666; margin-top: 8px;">
            âœ¨ Gemini AIê°€ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì—¬ ë„¤ì´ë²„ ë¸”ë¡œê·¸ìš© ì›ê³ ë¥¼ ìë™ ìƒì„±í•©ë‹ˆë‹¤ (1700-1800ì)
          </p>
        </div>
      </div>
    </div>
    
    <!-- AI ì›ê³  ìƒì„± iframe (í† ê¸€ ONì‹œ í‘œì‹œ) -->
    <div id="ai-manuscript-container" style="display: none; margin-bottom: 20px;">
      <iframe 
        id="ai-manuscript-iframe" 
        src="post/index.html" 
        style="width: 100%; height: 800px; border: 1px solid var(--border-color, #e0e0e0); border-radius: 8px; background: white;"
        frameborder="0">
      </iframe>
    </div>
    
    <div style="display: flex; align-items: center; gap: 15px; margin-top: 10px; flex-wrap: wrap;">
      <button id="exportBtn">ğŸ“¦ Export</button>
      <div class="manuscript-toggle-container">
        <label for="manuscriptToggle">ì›ê³  ì‘ì„±ìš© ì´í•©ë³¸ê³¼ íŒŒì¼ë¦¬ìŠ¤íŠ¸</label>
        <label class="toggle-switch">
          <input type="checkbox" id="manuscriptToggle" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="manuscript-toggle-container">
        <label for="videoToggle">ìµœì í™” ë¸”ë¡œê·¸ìš© ë™ì˜ìƒ</label>
        <label class="toggle-switch">
          <input type="checkbox" id="videoToggle" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>
    </div>
  </div>

  <div id="zoom-preview">
    <img src="" />
    <div id="zoom-category"></div>
  </div>

  <div id="preview-count-popup">
    <h4 style="margin: 0 0 10px 0; color: var(--button-bg);">ğŸ“Š ë¯¸ë¦¬ë³´ê¸° í˜„í™©</h4>
    <div id="preview-count-list"></div>
  </div>





  <div id="export-status">ì²˜ë¦¬ ì¤‘...</div>
  <div class="processing-message" id="processingMessage">ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...</div>
  <div class="progress-bar" id="progressBar">
    <div class="progress-fill" id="progressFill">0%</div>
  </div>

  <!-- ìŠ¤í¬ë¡¤ ë²„íŠ¼ ì¶”ê°€ -->
  <div class="scroll-buttons">
    <button class="scroll-btn scroll-to-top" id="scrollToTop" title="ë§¨ ìœ„ë¡œ"></button>
    <button class="scroll-btn scroll-to-bottom" id="scrollToBottom" title="ë§¨ ì•„ë˜ë¡œ"></button>
  </div>

  <div class="info-banner" style="background: #e3f2fd; border: 1px solid #1976d2; border-radius: 8px; padding: 15px; margin: 20px 0; color: #1565c0;">
    <h4 style="margin: 0 0 10px 0; color: #0d47a1;">ğŸ’¡ í•´ë‹¹ ë²„ì „ì—ì„œ ì¶”ê°€ëœ ê¸°ëŠ¥ : ë‹¨ìˆœí™”ëœ ë¦¬ì‚¬ì´ì§• ì‹œìŠ¤í…œ</h4>
    <ul style="margin: 5px 0; padding-left: 20px; line-height: 1.6;">
      <li><strong>ì—…ë¡œë“œ ë¦¬ì‚¬ì´ì§•:</strong> ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ì„¤ì •í•œ í¬ê¸°ë¡œ ìë™ ë¦¬ì‚¬ì´ì§• (ê¸°ë³¸: 1200px)</li>
      <li><strong>ì¼ê´€ì„± ë³´ì¥:</strong> ì—…ë¡œë“œë¶€í„° exportê¹Œì§€ ë™ì¼í•œ í’ˆì§ˆ ìœ ì§€</li>
      <li><strong>ìë™ì €ì¥ ì•ˆì •ì„±:</strong> ìš©ëŸ‰ ìµœì í™”ë¡œ ìë™ì €ì¥ ì—ëŸ¬ ì™„ì „ í•´ê²°</li>
      <li><strong>ê°„ë‹¨í•œ ì„¤ì •:</strong> ë³µì¡í•œ í¬ê¸° ì˜µì…˜ ì œê±°, í•„ìˆ˜ ë¦¬ì‚¬ì´ì§•ë§Œ ì ìš©</li>
    </ul>
  </div>

  <!-- ì‹œê°„ëŒ€ë³„ ë©”ì‹œì§€ -->
  <div class="time-message" id="timeMessage">
    <button class="close-btn" onclick="document.getElementById('timeMessage').classList.remove('active')">Ã—</button>
    <h3 id="timeMessageTitle"></h3>
    <p id="timeMessageText"></p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <!-- FFmpeg.wasm ì¶”ê°€ (MP4 ë³€í™˜ìš©) -->
  <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.0/dist/ffmpeg.min.js"></script>
  <script src="videoGeneratorSimple.js"></script>
  <script src="videoGeneratorMP4.js"></script>
  <script src="utils.js"></script>
  <script src="categoryManager.js"></script>
  <script src="stateManager.js"></script>
  <script src="stateManager_batch.js"></script>
  <script src="stateManager_save_enhanced.js"></script>
  <script src="manuscriptGenerator.js"></script>
  <script src="script.js"></script>
  
  <script>
    // ì‹œê°„ëŒ€ë³„ íŠ¹ë³„ ë©”ì‹œì§€
    window.addEventListener('load', () => {
        const now = new Date();
        const hour = now.getHours();
        const timeMessage = document.getElementById('timeMessage');
        const timeMessageTitle = document.getElementById('timeMessageTitle');
        const timeMessageText = document.getElementById('timeMessageText');
        
        if ((hour === 18 && now.getMinutes() >= 50) || hour >= 19 || hour < 4) {
            timeMessageTitle.innerHTML = '<span style="font-size: 1.3em; display: block; margin-bottom: 8px;">ğŸŒ™</span>ì•¼ê·¼ ì•Œë¦¼';
            timeMessageText.innerHTML = 'ì•¼ê·¼í•˜ì‹œë‚˜ìš”?<br>ê±´ê°• ì¡°ì‹¬í•˜ì„¸ìš”!<br>ìŠ¤íŠ¸ë ˆì¹­í•˜ê³ <br>ëˆˆë„ ì‰¬ì–´ì£¼ì„¸ìš”.';
            timeMessage.classList.add('active');
        } else if (hour === 12) {
            timeMessageTitle.innerHTML = '<span style="font-size: 1.3em; display: block; margin-bottom: 8px;">ğŸœ</span>ì ì‹¬ì‹œê°„';
            timeMessageText.innerHTML = 'ê³§ ì ì‹¬ì‹œê°„ì´ë„¤ìš”!<br>ë§›ìˆëŠ” ê±° ë“œì„¸ìš”!<br>ì˜¤í›„ë„ í™”ì´íŒ…!';
            timeMessage.classList.add('active');
        }
    });
  </script>
</body>
</html>