# SQL 데이터 관리 기능 설명

## 🚀 추가된 기능들

merge2 프로젝트의 menu-tab에 SQL 데이터 관리 기능이 추가되었습니다.

### 📊 SQL 데이터만 관리

#### 1. 📤 SQL 데이터 내보내기
- **기능**: SQL 데이터베이스의 메타데이터만 JSON 파일로 내보냅니다.
- **포함 내용**: 프로젝트 설정, 카테고리, 이미지 메타데이터 (실제 파일 제외)
- **파일 크기**: 작음 (몇 KB ~ MB)
- **용도**: 설정 백업, 메타데이터 이전

#### 2. 📥 SQL 데이터 가져오기
- **기능**: JSON 백업 파일에서 메타데이터를 복원합니다.
- **주의**: 실제 이미지 파일은 포함되지 않음

### 💾 전체 백업 관리 (SQL + 이미지)

#### 3. 💾 전체 백업 내보내기 ⭐ NEW!
- **기능**: SQL 데이터와 모든 이미지 파일을 하나의 ZIP 파일로 압축
- **포함 내용**:
  - `database.json`: 모든 SQL 데이터
  - `uploads/`: 모든 프로젝트의 이미지 파일들
  - `README.txt`: 백업 정보 및 복원 방법
- **파일 크기**: 이미지 수에 따라 큼 (수십 MB ~ GB)
- **파일명**: `photo_classifier_full_backup_YYYY-MM-DD_HHmmss.zip`
- **용도**: 완전한 백업, 서버 이전, 재해 복구

#### 4. 📦 전체 백업 가져오기 ⭐ NEW!
- **기능**: ZIP 백업 파일에서 전체 데이터와 이미지를 복원
- **제한**: 최대 100MB (서버 설정에 따라 조정 가능)
- **복원 내용**:
  - 모든 프로젝트 데이터
  - 모든 이미지 파일
  - 메타데이터 및 설정
- **특징**:
  - 중복 데이터는 자동으로 건너뜀
  - 기존 프로젝트는 업데이트
  - 새 프로젝트와 이미지는 추가

### 🔄 데이터 초기화

#### 5. 🔄 SQL 데이터 초기화
- **기능**: 모든 데이터를 완전히 삭제
- **삭제 대상**:
  - 모든 프로젝트 데이터
  - 모든 이미지 메타데이터
  - 업로드된 모든 파일
- **주의**: ⚠️ 되돌릴 수 없음 (2번 확인 필요)

## 📋 사용 시나리오

### 시나리오 1: 완전한 서버 이전
1. 기존 서버: **💾 전체 백업 내보내기** → ZIP 파일 다운로드
2. 새 서버: 애플리케이션 설치
3. 새 서버: **📦 전체 백업 가져오기** → ZIP 파일 업로드
4. 완료! 모든 데이터와 이미지가 복원됨

### 시나리오 2: 가벼운 설정 백업
1. **📤 SQL 데이터 내보내기** → JSON 파일 다운로드
2. 필요시 **📥 SQL 데이터 가져오기**로 설정만 복원

### 시나리오 3: JSON 파싱 오류 해결
1. **💾 전체 백업 내보내기**로 안전한 백업 생성
2. **🔄 SQL 데이터 초기화**로 데이터베이스 정리
3. **📦 전체 백업 가져오기**로 깨끗한 데이터 복원

### 시나리오 4: 정기적인 백업
- 주간: **📤 SQL 데이터 내보내기** (가벼운 백업)
- 월간: **💾 전체 백업 내보내기** (완전한 백업)

## 🛠️ 기술 사양

### 파일 구조
```
photo_classifier_full_backup_YYYY-MM-DD_HHmmss.zip
├── database.json          # SQL 데이터
├── README.txt            # 백업 정보
└── uploads/              # 이미지 파일들
    ├── project_xxxxx/    # 프로젝트별 폴더
    │   ├── image1.jpg
    │   ├── image2.png
    │   └── ...
    └── project_yyyyy/
        └── ...
```

### API 엔드포인트
- `api/data_management.php`: SQL 데이터 관리
- `api/data_export_full.php`: 전체 백업 내보내기
- `api/data_import_full.php`: 전체 백업 가져오기

### 서버 요구사항
- PHP 7.0 이상
- ZipArchive 확장 모듈 (전체 백업용)
- 충분한 임시 디스크 공간
- `upload_max_filesize`: 100M 이상 권장
- `post_max_size`: 100M 이상 권장
- `max_execution_time`: 300초 이상 권장

## ⚠️ 주의사항

1. **백업 파일 보안**: 백업 파일에는 모든 데이터가 포함되므로 안전하게 보관하세요.

2. **파일 크기 제한**: 
   - 전체 백업 가져오기는 100MB 제한 (프론트엔드)
   - 서버 설정에 따라 조정 가능

3. **서버 리소스**: 
   - 대용량 백업 생성/복원 시 서버 리소스를 많이 사용할 수 있습니다.
   - 가능하면 사용자가 적은 시간대에 실행하세요.

4. **ZIP 확장 모듈**: 
   - 전체 백업 기능은 PHP ZipArchive 확장이 필요합니다.
   - 대부분의 호스팅에서 기본 제공되지만, 없으면 호스팅 업체에 요청하세요.

## 🔧 문제 해결

### "ZIP extension is not installed" 오류
- PHP ZipArchive 확장이 설치되지 않음
- 해결: 호스팅 업체에 ZIP 확장 설치 요청

### 백업 파일이 너무 큼
- 이미지를 정리하거나 압축 후 백업
- 또는 프로젝트별로 나누어 백업

### 가져오기 실패
- 파일 크기 제한 확인 (php.ini 설정)
- 메모리 제한 확인
- 실행 시간 제한 확인

## 📝 업데이트 내역

### v2.0 (2025-08-20)
- ✅ 전체 백업 내보내기 기능 추가 (SQL + 이미지 ZIP 압축)
- ✅ 전체 백업 가져오기 기능 추가 (ZIP 파일 복원)
- ✅ 메뉴 UI 개선 (섹션 구분)
- ✅ 백업 정보 파일 (README.txt) 자동 생성

### v1.0 (초기 버전)
- ✅ SQL 데이터 내보내기/가져오기
- ✅ SQL 데이터 초기화